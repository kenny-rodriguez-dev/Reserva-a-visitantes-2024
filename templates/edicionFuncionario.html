{% extends "base_admin.html" %}
{% load static %}
{% block title %}Edicion Funcionario{% endblock %}

{% block content %}
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1>Editar Funcionario</h1>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="{% url 'adminInicio' %}">Home</a></li>
                        <li class="breadcrumb-item active">Editar Funcionario</li>
                    </ol>
                </div>
            </div>
        </div><!-- /.container-fluid -->
    </section>
    <!-- Main content -->
    <section class="content">
        <div class="container-fluid">
            <div class="card">
                <div class="card-body">
                    <form  action="/editarFuncionario/" method="post"
                                enctype="multipart/form-data">{% csrf_token %}
                                <div class="row d-none">
                                    <div class="form-group">
                                        <label for="" class="d-none">ID</label>
                                        <input type="text" name="funcionarioid" id="funcionarioid" class="form-control d-none" value="{{ funcionario.id }}" readonly required>
                                    </div>
                                </div>
                                <!-- Nombre y Apellido -->
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Nombre</label>
                                            <input type="text" class="form-control" name="nombres" id="nombres" value="{{ funcionario.id_persona.nombres|title }}" pattern="[^0-9]*" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Apellido</label>
                                            <input type="text" class="form-control" name="apellidos" id="apellidos" value="{{ funcionario.id_persona.apellidos|title }}" pattern="[^0-9]*" required>
                                        </div>
                                    </div>
                                </div>
                                <!-- Email y Cédula -->
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Email</label>
                                            <input type="email" class="form-control" name="email" id="email" value="{{ funcionario.id_persona.email }}"  required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Cédula</label>
                                            <input type="text" class="form-control" name="cedula" id="cedula" value="{{ funcionario.id_persona.cedula }}" pattern="^[0-9999999999]+" maxlength="10" minlength="10" disabled  required>
                                        </div>
                                    </div>
                                </div>
                                <!-- Teléfono y Imagen -->
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Teléfono</label>
                                            <input type="text" class="form-control" name="telefono" id="telefono" value="{{ funcionario.id_persona.telefono }}" 
                                            pattern="^[0-9999999999]+" maxlength="10" minlength="10">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="exampleInputFile">Imagen</label>
                                            <div class="input-group">
                                                <div class="custom-file">
                                                    <input class="form-control" type="file" name='avatar' id='avatar' value=""  placeholder={{funcionario.id_persona.avatar}}>
                                                    <label class="custom-file-label" for="avatar">Seleccionar archivo</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>                       
                                </div>
                                <!-- Cargo -->
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Ciudad</label>
                                            <input type="text" class="form-control" name="ciudad" id="ciudad" value="{{ funcionario.id_persona.ciudad|title }} " pattern="[^0-9]*" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="horario">Horarios</label>
                                            <select name="horario" id="horario" class="form-control custom-select" multiple>
                                                {% for horario in horarios %}
                                                    {% if horario in funcionario.horario.all %}
                                                        <option selected value="{{ horario.id }}">{{ horario.HorarioInicio }} - {{ horario.HorarioFin }}</option>
                                                    {% else %}
                                                        <option value="{{ horario.id }}">{{ horario.HorarioInicio }} - {{ horario.HorarioFin }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">                              
                                        <div class="form-group">
                                            <label for="cargo">Cargo</label>
                                            <select name="cargo" id="cargo"  class="form-control custom-select">
                                              <option disabled>Seleccione un cargo</option>
                                                {% for c in cargo %}
                                                <option {% if c.id == funcionario.id_cargo.id %} selected {% endif %} value="{{ c.id }}">{{ c.nombre }}</option>                                      
                                                {% endfor %}
                                            </select>
                                          </div>
                                    </div>
                                </div>
                                    <a href="{% url 'adminFuncionario' %}" class="btn btn-secondary">Cerrar</a>
                                    <button type="submit" class="btn btn-primary">Actualizar</button>
                            </form>
                </div>
                <!-- /.card-body -->
            </div>
        </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->
</div>
{% endblock %}

{% block datatables %}
<script>

    $(function () {
        const select = document.getElementById("horario");
        select.addEventListener("mousedown", function(event) {
            event.preventDefault();
            
            const select = this;
            const scroll = select.scrollTop;
            
            event.target.selected = !event.target.selected;
            
            setTimeout(function() {
                select.scrollTop = scroll;
            }, 0);
            
            select.focus();
        });
    });
</script>
{% endblock %}